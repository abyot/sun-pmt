<script type="text/javascript">
	jQuery(document).ready(function() {
	 
		validation2( "addGateWayConfigForm", function( form ) {
			saveGatewayConfig();
		}, {
			'rules' : getValidationRulesGateway()
		} );
		
		changeValueType( getFieldValue( 'gatewayType' ) );
    });
    function checkDuplicatedKeyName( value, index )
    {
        for (var i=1; i<=jQuery('.trNewParam').length; i++ )
        {
            if ( i != index )
            {
                var otherValue = document.getElementById('name'+i).value;
                if( value!='' && value == otherValue )
                {
                    markInvalid( 'name'+index, 'Duplicated Name' );
                    break;
                }
                else
                {
                    markValid( 'name'+index );
                }
            }
        }
    };
	
	var i18n_add_update_success = '$encoder.jsEscape( $i18n.getString( "add_update_gateway_success" ) , "'")';
	var i18n_required_data_error = '$encoder.jsEscape( $i18n.getString( "required_data_error" ) , "'" )';
    var i18_new_key = '$encoder.jsEscape( $i18n.getString( "new_key" ) , "'" )';
    var i18_value = '$encoder.jsEscape( $i18n.getString( "value" ) , "'" )';
    var i18_text = '$encoder.jsEscape( $i18n.getString( "text" ) , "'" )';
    var i18_password = '$encoder.jsEscape( $i18n.getString( "password" ) , "'" )';


</script>
<h3>$i18n.getString( "add_update_gateway_management" )</h3>
<form id="addGateWayConfigForm" name="addGateWayConfigForm">
	<table id="detailsList">
		<tr>
			<th colspan="2">$i18n.getString( "gateway_type" )</th>
		</tr>
		<tr>
			<td>$i18n.getString( "type" ):</td>
			<td>
				<select id="gatewayType" style="width: 28em" onchange="changeValueType( this.value )">
					<option value="bulksms" #if ( $!index == $!bulkIndex ) selected='selected' #end>$i18n.getString( "bulk_gw" )</option>
					<option value="clickatell" #if ( $!index == $!clickatellIndex ) selected='selected' #end>$i18n.getString( "clickatell_gw" )</option>
					<option value="http" #if ( $!index == $!httpIndex ) selected='selected' #end>$i18n.getString( "generic_http_gw" )</option>
				</select>
			</td>
		</tr>
		<tr>
			<th colspan="2">$i18n.getString( "gateway_configuration" )</th>
		</tr>
		#set( $bulkGateway = $!gatewayConfigMap.get( $bulkIndex ) )
		<tbody id="bulksmsFields">
			<tr>
				<td>$i18n.getString( "gateway_name" ):</td>
				<td><input type="text" name="name" id="name" style="width: 28em" value="$!encoder.htmlEncode( $!bulkGateway.name )"/></td>
			</tr>
			<tr>
				<td>$i18n.getString( "username" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="text" name="username" id="username" style="width: 28em" value="$!bulkGateway.username"/></td>
			</tr> 
			<tr>
				<td>$i18n.getString( "password" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="password" name="password" id="password" style="width: 28em" value="$!bulkGateway.password"/></td>
			</tr>

			<tr>
				<td>$i18n.getString( "region" ):</td>
				<td>
					<select id="region" name="region" style="width:100%;">
						<option value="INTERNATIONAL" #if ( $bulkGateway.region == "INTERNATIONAL" ) selected #end>$i18n.getString( "international" )</option>
						<option value="UNITEDKINGDOM" #if ( $bulkGateway.region == "UNITEDKINGDOM" ) selected #end>$i18n.getString( "uk" )</option>
						<option value="SOUTHAFRICA" #if ( $bulkGateway.region == "SOUTHAFRICA" ) selected #end>$i18n.getString( "south_africa" )</option>
						<option value="SPAIN" #if ( $bulkGateway.region == "SPAIN" ) selected #end>$i18n.getString( "spain" )</option>
						<option value="USA" #if ( $bulkGateway.region == "USA" ) selected #end>$i18n.getString( "usa" )</option>
						<option value="GERMANY" #if ( $bulkGateway.region == "GERMANY" ) selected #end>$i18n.getString( "germany" )</option>
					</select>
				</td>
			</tr>
		</tbody>
		#set( $clickatellGateway = $!gatewayConfigMap.get( $clickatellIndex ) )
		<tbody id="clickatellFields">
			<tr>
				<td>$i18n.getString( "gateway_name" ):</td>
				<td><input type="text" name="name" id="name" style="width: 28em" value="$!encoder.htmlEncode( $!clickatellGateway.name )"/></td>
			</tr>
			<tr>
				<td>$i18n.getString( "username" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="text" name="username" id="username" style="width: 28em" value="$!clickatellGateway.username"/></td>
			</tr>
			<tr>
				<td>$i18n.getString( "password" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="password" name="password" id="password" style="width: 28em" value="$!clickatellGateway.password"/></td>
			</tr>	
			<tr>
				<td>$i18n.getString( "authToken" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="password" name="authToken" id="authToken" style="width: 28em" value="$!encoder.htmlEncode( $!clickatellGateway.authToken )"/></td>
			</tr>
			
		</tbody>
		
		#set( $httpGateway = $!gatewayConfigMap.get( $httpIndex ) )
		<tbody id="genericHTTPFields">
			<tr>
				<td>$i18n.getString( "gateway_name" ):</td>
				<td><input type="text" name="name" id="name" style="width: 28em" value="$!encoder.htmlEncode( $!httpGateway.name )"/></td>
			</tr>
			<tr>
				<td>$i18n.getString( "messageParameter" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="text" name="messageParameter" id="messageParameter" style="width: 28em" value="$!httpGateway.messageParameter"/></td>
			</tr>
			<tr>
				<td>$i18n.getString( "recipientParameter" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="text" name="recipientParameter" id="recipientParameter" style="width: 28em" value="$!httpGateway.recipientParameter"/></td>
			</tr>
			
			<tr>
				<td>$i18n.getString( "url_template" ) <em title="$i18n.getString( 'required' )" class="required">*</em>:</td>
				<td><input type="text" name="urlTemplate" id="urlTemplate" style="width: 28em" value="$!encoder.htmlEncode( $!httpGateway.urlTemplate )"/></td>
			</tr>
		</tbody>
		<tr>
			<td colspan="2" align="right">
				<input id="addmore" type="button" value="$i18n.getString('add_more')" onclick="generateaddKeyValueParamForm()"/>
				<input id="savesettings" type="submit" value="$i18n.getString( 'save_settings' )" style="width:8em"/>
				<input type="button" value="$i18n.getString( 'back' )" onclick="window.location.href='showSMSConfigureForm.action'" style="width:8em"/>
			</td>
		</tr>
	</table>
</form>

